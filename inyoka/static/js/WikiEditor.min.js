(function(){var p={text:"Code ohne Highlighting",bash:"Bash",c:"C",csharp:"C#",cpp:"C++",css:"CSS",d:"D","html+django":"Django / Jinja Templates",html:"HTML",irc:"IRC Logs",java:"Java",js:"JavaScript",perl:"Perl","html+php":"PHP",python:"Python",pycon:"Python Console Sessions",pytb:"Python Tracebacks",ruby:"Ruby",sourceslist:"sources.list",sql:"SQL",xml:"XML"},j=function(a,b,c,d,e){return function(h){if(!d||$.inArray(h.profile,d)>-1)return $('<a href="#" class="button" />').attr("id","button-"+a).attr("title",
b).mouseover(function(g){g.preventDefault();e.call(h,g)}).mouseout(function(g){g.preventDefault()}).append($("<span />").text(b)).click(function(g){g.preventDefault();return c.call(h,g)})}},n=function(a,b,c,d,e,h){return function(g){if(!(e&&$.inArray(g.profile,e))){var m=$("<select />").attr("id","dropdown-"+a).attr("title",b).append($('<option class="title" value="" />').text(b)).mouseover(function(l){h.call(g,l)}).mouseout(function(){}).change(function(l){d.call(g,l)});$.each(c,function(){m.append(this)});
m[0].selectedIndex=0;return m}}},f=function(a,b){return $("<option />").val(a).text(b||a)},k=function(a,b){return function(){return this.insertTag(a,typeof b=="undefined"?"Formatierter Text":b)}},i=function(){return function(){}},o=function(a){var b;return a.getUTCFullYear()+"-"+(b=a.getUTCMonth(),b<9?"0":"")+(b+1)+"-"+(b=a.getUTCDate(),b<10?"0":"")+b+"T"+(b=a.getUTCHours(),b<10?"0":"")+b+":"+(b=a.getUTCMinutes(),b<10?"0":"")+b+":"+(b=a.getUTCSeconds(),b<10?"0":"")+b+"Z"},q=function(){return[n("headline",
"\u00dcberschrift",[f("=","\u00dcberschrift: Stufe 1"),f("==","\u00dcberschrift: Stufe 2"),f("===","\u00dcberschrift: Stufe 3"),f("====","\u00dcberschrift: Stufe 4"),f("=====","\u00dcberschrift: Stufe 5")],function(a){var b=a.target.value;b.length>0&&this.insertTag(b+" %s "+b+"\n","\u00dcberschrift");a.target.selectedIndex=0},["wiki"],i("= \u00dcberschrift =")),j("bold","Fetter Text",k("'''%s'''"),["wiki","forum","small"],i("'''Text'''")),j("italic","Kursiver Text",k("''%s''"),["wiki","forum","small"],
i("''Text''")),j("underlined","Unterstrichener Text",k("__%s__"),["forum","small"],i("__Text__")),j("stroke","Durchgestrichener Text",k("--(%s)--"),["forum"],i("--(Text)--")),j("monospace","Monotype",k("`%s`"),["wiki"],i("`Text`")),j("mark","Hervorgehobener Text",k("[mark]%s[/mark]"),["forum"],i("[mark]Text[/mark]")),j("wiki-link","Wiki-Link",k("[:%s:]","Seitenname"),["wiki","forum"],i("[:Seitenname:(Linktext)]")),j("external-link","Externer Link",k("[%s]","http://www.example.org/"),["wiki","forum",
"small"],i("[www.example.com]")),j("user-link","Benutzerlink",k("[user:%s:]","Benutzername"),["wiki","forum"],i("[user:Beispiel:]")),j("quote","Auswahl zitieren",function(){var a=this.getSelection();a.length&&this.setSelection(this.quoteText(a))},["wiki","forum"],i("Auswahl zitieren")),j("picture","Bild",k("[[Bild(%s)]]","Bildname"),["wiki","forum"],i("[[Bild(Bildname)]]")),j("pre","Codeblock",k("{{{\n%s\n}}}","Code"),["wiki","forum"],i("{{{ Code }}}")),function(a){if(a.profile!="small"){var b=$("<div />");
j("code","Code",function(){c.slideToggle("fast");return false},["wiki","forum"],i("Code einf\u00fcgen"))(a).appendTo(b);var c=$('<table class="codebox" />').appendTo(b).hide();c[0].style.display="none";var d=[$("<td>Rohtext</td>").click(function(){a.insertTag("{{{\n%s\n}}}","Code")})];$.each(p,function(h,g){d.push($("<td>"+g+"</td>").click(function(){a.insertTag("{{{#!code "+h+"\n%s\n}}}","Code")}))});for(var e=0;e<d.length/2;e++)$("<tr />").appendTo(c).append(d[e],d[e+d.length/2]);$(document).click(function(){c.is(":visible")&&
c.slideUp("fast")});return b}},function(a){if(a.profile=="forum"){var b=$("<div />");j("smilies","Smilies",function(){c.slideToggle("fast");return false},["forum"],i("Smiley einf\u00fcgen"))(a).appendTo(b);var c=$('<ul class="smileybox" />').appendTo(b).hide();c[0].style.display="none";$.getJSON("/?__service__=wiki.get_smilies",function(d){$.each(d,function(){var e=this[0],h=this[1];$("<li />").append($("<img />").attr("src",h).attr("alt",e).click(function(){a.insertText(" "+e+" ")})).appendTo(c)})});
$(document).click(function(){c.is(":visible")&&c.slideUp("fast")});return b}},j("date","Datum",function(){this.insertTag("[[Datum(%s)]]",o(new Date))},["wiki"],i("[[Datum(DATUM)]]")),j("sig","Signatur",function(){this.insertText(" --- "+(this.username?"[user:"+this.username.replace(":","::")+":], ":"")+"[[Datum("+o(new Date)+")]]")},["wiki"],i("Signatur einf\u00fcgen")),n("macro","Makro",[f("[[FehlendeSeiten(%s)]]","Fehlende Seiten"),f("[[TagListe(%s)]]","Tag-Liste"),f("[[Anh\u00e4nge(%s)]]","Anh\u00e4nge"),
f("[[Seitenzahl(%s)]]","Seitenzahl"),f("[[Inhaltsverzeichnis(%s)]]","Inhaltsverzeichnis"),f("[[Einbinden(%s)]]","Seite einbinden"),f("[[Seitenliste(%s)]]","Seitenliste"),f("[[Seitenname(%s)]]","Aktueller Seitenname"),f("[[Weiterleitungen(%s)]]","Weiterleitungen"),f("[[\u00c4hnlicheSeiten(%s)]]","\u00c4hnliche Seiten"),f("[[TagWolke(%s)]]","Tag-Wolke"),f("[[Letzte\u00c4nderungen(%s)]]","Letzte \u00c4nderungen"),f("[[VerwaisteSeiten(%s)]]","Verwaiste Seiten"),f("[[NeueSeiten(%s)]]","Neue Seiten")],
function(a){a.target.value.length>0&&this.insertTag(a.target.value,"");a.target.selectedIndex=0},["wiki"],i("Makros einf\u00fcgen")),n("template","Vorlage",[f("[[Vorlage(Tasten, %s)]]","Tasten"),f("{{{#!vorlage Befehl\n%s\n}}}","Befehl"),f("{{{#!vorlage Hinweis\n%s\n}}}","Hinweis"),f("{{{#!vorlage Warnung\n%s\n}}}","Warnung"),f("[[Vorlage(Getestet, %s)]]","Getestet"),f('[[Vorlage(Fremd, Paket, "%s")]]',"Fremdpakete-Warnung"),f('[[Vorlage(Fremd, Quelle, "%s")]]',"Fremdquelle-Warnung"),f("{{{#!vorlage Experten\n%s\n}}}",
"Experten-Info")],function(a){a.target.value.length>0&&this.insertTag(a.target.value,"");a.target.selectedIndex=0},["wiki"],i("Vorlagen einf\u00fcgen")),j("shrink","Eingabefeld verkleinern",function(){var a=this.textarea.height()-50;this.textarea.height(a>=100?a:100).focus()},["forum","wiki"],i("Eingabefeld verkleinern")),j("enlarge","Eingabefeld vergr\u00f6\u00dfern",function(){this.textarea.height(this.textarea.height()+50).focus()},["forum","wiki"],i("Eingabefeld vergr\u00f6\u00dfern"))]};WikiEditor=
function(a,b){var c;this.profile=b||"small";this.username=$CURRENT_USER||"Anonymous";this.smilies=null;this.textarea=$(a);this.textarea[0].inyokaWikiEditor=this;c=$('<ul class="toolbar" />').prependTo(this.textarea.parent());for(var d=q(),e=0,h=d.length,g;e!=h;++e)if(g=d[e](this))g.appendTo($("<li />").appendTo(c));link=b=="wiki"?"http://wiki.ubuntuusers.de/Wiki/Syntax":"http://wiki.ubuntuusers.de/Forum/Syntax";$('<span class="syntax_help note"><a href="'+link+'">Hilfe zur Syntax</a></span>').appendTo($("<li />").appendTo(c))};
WikiEditor.prototype.onKeyDown=function(a){if(a.keyCode==13){var b=this.getCurrentLine().match(/^(\s*(?:\*|- |[01aAiI]\.)?\s*)(.*?)$/);if(b[1].length){a.preventDefault();b[2].length?this.insertText("\n"+b[1]):this.setCurrentLine("\n")}}else if(a.keyCode==9){a.preventDefault();a=this.getCurrentLine().length;b=(Math.floor(a/2)+1)*2;for(var c="";a<b&&(c+=" ");++a);this.insertText(c)}};WikiEditor.prototype.insertTag=function(a,b){var c=this.textarea[0],d=a instanceof Array?a:a.split("%s",2),e=d[0]||"";
d=d[1]||"";scroll=c.scrollTop;if(typeof c.selectionStart!="undefined"){var h=c.selectionStart,g=c.selectionEnd,m=c.value.substring(0,h),l=c.value.substring(h,g),r=c.value.substring(g);l=g!=h?e+l+d:e+b+d;c.value=m+l+r;c.focus();c.selectionStart=h+e.length;c.selectionEnd=h+(l.length-d.length)}else if(typeof document.selection!="undefined"){c.focus();h=document.selection.createRange();g=h.text;h.text=e+(g.length>0?g:b)+d}c.scrollTop=scroll};WikiEditor.prototype.getSelection=function(){var a=this.textarea[0];
if(typeof a.selectionStart!="undefined"){var b=a.selectionStart,c=a.selectionEnd;return b==c?"":a.value.substring(b,c)}else if(typeof document.selection!="undefined")return document.selection.createRange().text};WikiEditor.prototype.setSelection=function(a,b){var c=this.textarea[0];if(typeof c.selectionStart!="undefined"){var d=c.selectionStart,e=c.selectionEnd,h=c.value.substring(0,d);e=c.value.substring(e);c.value=h+a+e;c.focus();if(b){c.selectionStart=d;c.selectionEnd=d+a.length}else c.selectionEnd=
c.selectionStart=d+a.length}else if(typeof document.selection!="undefined"){c.focus();document.selection.createRange().text=a}};WikiEditor.prototype.insertText=function(a){var b=this.textarea[0];if(typeof b.selectionStart!="undefined")b.selectionStart=b.selectionEnd;this.setSelection(a)};WikiEditor.prototype.getCurrentLine=function(){var a=this.textarea[0],b,c;if(typeof a.selectionStart!="undefined"){var d=[];for(b=a.selectionEnd-1;(c=a.value.charAt(b))!="\n"&&c;b--)d.push(c);d.reverse();for(b=a.selectionEnd;(c=
a.value.charAt(b))!="\n"&&c;b++)d.push(c);return d.join("")}return""};WikiEditor.prototype.setCurrentLine=function(a){var b=this.textarea[0];if(typeof b.selectionStart!="undefined"){var c,d,e;for(c=b.selectionEnd-1;(e=b.value.charAt(c))!="\n"&&e;c--);for(d=b.selectionEnd;(e=b.value.charAt(d))!="\n"&&e;d++);b.value=b.value.substring(0,c)+a+b.value.substring(d);b.selectionStart=b.selectionEnd=c+a.length}};WikiEditor.prototype.quoteText=function(a){if(!a)return"";var b=[];$.each(a.split(/\r\n|\r|\n/),
function(){b.push(">"+(this.charAt(0)!=">"?" ":"")+this)});return b.join("\n")+"\n"}})();
