(function(){var o={text:"Code ohne Highlighting",bash:"Bash",c:"C",csharp:"C#",cpp:"C++",css:"CSS",d:"D","html+django":"Django / Jinja Templates",html:"HTML",irc:"IRC Logs",java:"Java",js:"JavaScript",perl:"Perl","html+php":"PHP",python:"Python",pycon:"Python Console Sessions",pytb:"Python Tracebacks",ruby:"Ruby",sourceslist:"sources.list",sql:"SQL",xml:"XML"},j=function(b,c,a,d,e){return function(g){if(!d||$.inArray(g.profile,d)>-1)return $('<a href="#" class="button" />').attr("id","button-"+b).attr("title",
c).mouseover(function(f){f.preventDefault();e.call(g,f)}).mouseout(function(f){f.preventDefault()}).append($("<span />").text(c)).click(function(f){f.preventDefault();return a.call(g,f)})}},n=function(b,c,a,d,e,g){return function(f){if(!(e&&$.inArray(f.profile,e))){var m=$("<select />").attr("id","dropdown-"+b).attr("title",c).append($('<option class="title" value="" />').text(c)).mouseover(function(l){g.call(f,l)}).mouseout(function(){}).change(function(l){d.call(f,l)});$.each(a,function(){m.append(this)});
m[0].selectedIndex=0;return m}}},h=function(b,c){return $("<option />").val(b).text(c||b)},k=function(b,c){return function(){return this.insertTag(b,typeof c=="undefined"?"Formatierter Text":c)}},i=function(){return function(){}},p=function(){return[j("bold","Fetter Text",k("'''%s'''"),["wiki","forum","small"],i("'''Text'''")),j("italic","Kursiver Text",k("''%s''"),["wiki","forum","small"],i("''Text''")),j("underlined","Unterstrichener Text",k("__%s__"),["forum","small"],i("__Text__")),j("stroke",
"Durchgestrichener Text",k("--(%s)--"),["forum"],i("--(Text)--")),j("monospace","Monotype",k("`%s`"),["wiki"],i("`Text`")),j("mark","Hervorgehobener Text",k("[mark]%s[/mark]"),["forum"],i("[mark]Text[/mark]")),j("wiki-link","Wiki-Link",k("[:%s:]","Seitenname"),["wiki","forum"],i("[:Seitenname:(Linktext)]")),j("external-link","Externer Link",k("[%s]","http://www.example.org/"),["wiki","forum","small"],i("[www.example.com]")),j("user-link","Benutzerlink",k("[user:%s:]","Benutzername"),["forum"],i("[user:Beispiel:]")),
j("quote","Auswahl zitieren",function(){var b=this.getSelection();b.length&&this.setSelection(this.quoteText(b))},["forum"],i("Auswahl zitieren")),j("picture","Bild",k("[[Bild(%s)]]","Bildname"),["wiki","forum"],i("[[Bild(Bildname)]]")),j("pre","Codeblock",k("{{{\n%s\n}}}","Code"),["wiki","forum"],i("{{{ Code }}}")),function(b){if(!(b.profile=="small"||b.profile=="wiki")){var c=$("<div />");j("code","Code",function(){a.slideToggle("fast");return false},["wiki","forum"],i("Code einf\u00fcgen"))(b).appendTo(c);
var a=$('<table class="codebox" />').appendTo(c).hide();a[0].style.display="none";var d=[$("<td>Rohtext</td>").click(function(){b.insertTag("{{{\n%s\n}}}","Code")})];$.each(o,function(g,f){d.push($("<td>"+f+"</td>").click(function(){b.insertTag("{{{#!code "+g+"\n%s\n}}}","Code")}))});for(var e=0;e<d.length/2;e++)$("<tr />").appendTo(a).append(d[e],d[e+d.length/2]);$(document).click(function(){a.is(":visible")&&a.slideUp("fast")});return c}},function(b){if(b.profile=="forum"){var c=$("<div />");j("smilies",
"Smilies",function(){a.slideToggle("fast");return false},["forum"],i("Smiley einf\u00fcgen"))(b).appendTo(c);var a=$('<ul class="smileybox" />').appendTo(c).hide();a[0].style.display="none";$.getJSON("/?__service__=wiki.get_smilies",function(d){$.each(d,function(){var e=this[0],g=this[1];$("<li />").append($("<img />").attr("src",g).attr("alt",e).click(function(){b.insertText(" "+e+" ")})).appendTo(a)})});$(document).click(function(){a.is(":visible")&&a.slideUp("fast")});return c}},n("headline","\u00dcberschrift",
[h("=","\u00dcberschrift: Stufe 1"),h("==","\u00dcberschrift: Stufe 2"),h("===","\u00dcberschrift: Stufe 3"),h("====","\u00dcberschrift: Stufe 4"),h("=====","\u00dcberschrift: Stufe 5")],function(b){var c=b.target.value;c.length>0&&this.insertTag(c+" %s "+c+"\n","\u00dcberschrift");b.target.selectedIndex=0},["wiki"],i("= \u00dcberschrift =")),n("macro","Textbausteine",[h("[[Vorlage(InArbeit, %s)]]","in Arbeit"),h("[[Inhaltsverzeichnis(%s)]]","Inhaltsverzeichnis"),h("[[Vorlage(Getestet, %s)]]","Getestet"),
h("[[Vorlage(Paketinstallation, %s)]]","Paketinstallation"),h("{{{#!vorlage Befehl\n%s\n}}}","Befehl"),h("[[Vorlage(PPA, %s)]]","PPA-Vorlage"),h("{{{#!vorlage Hinweis\n%s\n}}}","Hinweis"),h('[[Vorlage(Fremd, Quelle, "%s")]]',"Fremdquelle-Warnung"),h("{{{#!vorlage Warnung\n%s\n}}}","Warnung"),h("{{{#!vorlage Experten\n%s\n}}}","Experten-Info")],function(b){b.target.value.length>0&&this.insertTag(b.target.value,"");b.target.selectedIndex=0},["wiki"],i("Textbausteine einf\u00fcgen")),n("textformat",
"Textformat",[h("'''Verzeichnisse'''","Verzeichnisse"),h("''\"Men\u00fc -> Untermen\u00fc -> Men\u00fcbefehl\"''","Men\u00fcs"),h("'''Dateien'''","Dateien"),h("`Befehl`","Befehl")],function(b){b.target.value.length>0&&this.insertTag(b.target.value,"");b.target.selectedIndex=0},["wiki"],i("Textformat einf\u00fcgen")),j("shrink","Eingabefeld verkleinern",function(){var b=this.textarea.height()-50;this.textarea.height(b>=100?b:100).focus()},["forum","wiki"],i("Eingabefeld verkleinern")),j("enlarge",
"Eingabefeld vergr\u00f6\u00dfern",function(){this.textarea.height(this.textarea.height()+50).focus()},["forum","wiki"],i("Eingabefeld vergr\u00f6\u00dfern"))]};WikiEditor=Class.$extend({__init__:function(b,c){var a;this.profile=c||"small";this.username=$CURRENT_USER||"Anonymous";this.smilies=null;this.textarea=$(b);this.textarea[0].inyokaWikiEditor=this;a=$('<ul class="toolbar" />').prependTo(this.textarea.parent());for(var d=p(),e=0,g=d.length,f;e!=g;++e)if(f=d[e](this))f.appendTo($("<li />").appendTo(a));
link=c=="wiki"?"http://wiki.ubuntuusers.de/Wiki/Syntax":"http://wiki.ubuntuusers.de/Forum/Syntax";$('<span class="syntax_help note"><a href="'+link+'">Hilfe zur Syntax</a></span>').appendTo($("<li />").appendTo(a))},keycodes:function(b,c){if(c.keyCode==13){var a=b.getCurrentLine().match(/^(\s*(?:\*|- |[01aAiI]\.)?\s*)(.*?)$/);if(a[1].length){c.preventDefault();a[2].length?this.insertText("\n"+a[1]):this.setCurrentLine("\n")}}else if(c.keyCode==9){c.preventDefault();a=b.getCurrentLine().length;for(var d=
(Math.floor(a/2)+1)*2,e="";a<d&&(e+=" ");++a)this.insertText(e)}},insertTag:function(b,c){var a=this.textarea[0],d=b instanceof Array?b:b.split("%s",2),e=d[0]||"";d=d[1]||"";scroll=a.scrollTop;if(typeof a.selectionStart!="undefined"){var g=a.selectionStart,f=a.selectionEnd,m=a.value.substring(0,g),l=a.value.substring(g,f),q=a.value.substring(f);l=f!=g?e+l+d:e+c+d;a.value=m+l+q;a.focus();a.selectionStart=g+e.length;a.selectionEnd=g+(l.length-d.length)}else if(typeof document.selection!="undefined"){a.focus();
g=document.selection.createRange();f=g.text;g.text=e+(f.length>0?f:c)+d}a.scrollTop=scroll},getSelection:function(){var b=this.textarea[0];if(typeof b.selectionStart!="undefined"){var c=b.selectionStart,a=b.selectionEnd;return c==a?"":b.value.substring(c,a)}else if(typeof document.selection!="undefined")return document.selection.createRange().text},setSelection:function(b,c){var a=this.textarea[0];if(typeof a.selectionStart!="undefined"){var d=a.selectionStart,e=a.selectionEnd,g=a.value.substring(0,
d);e=a.value.substring(e);a.value=g+b+e;a.focus();if(c){a.selectionStart=d;a.selectionEnd=d+b.length}else a.selectionEnd=a.selectionStart=d+b.length}else if(typeof document.selection!="undefined"){a.focus();document.selection.createRange().text=b}},insertText:function(b){var c=this.textarea[0];if(typeof c.selectionStart!="undefined")c.selectionStart=c.selectionEnd;this.setSelection(b)},getCurrentLine:function(){var b=this.textarea[0],c,a;if(typeof b.selectionStart!="undefined"){var d=[];for(c=b.selectionEnd-
1;(a=b.value.charAt(c))!="\n"&&a;c--)d.push(a);d.reverse();for(c=b.selectionEnd;(a=b.value.charAt(c))!="\n"&&a;c++)d.push(a);return d.join("")}return""},setCurrentLine:function(b){var c=this.textarea[0];if(typeof c.selectionStart!="undefined"){var a,d,e;for(a=c.selectionEnd-1;(e=c.value.charAt(a))!="\n"&&e;a--)for(d=c.selectionEnd;(e=c.value.charAt(d))!="\n"&&e;d++)c.value=c.value.substring(0,a)+b+c.value.substring(d);c.selectionStart=c.selectionEnd=a+b.length}},quoteText:function(b){if(!b)return"";
var c=[];$.each(b.split(/\r\n|\r|\n/),function(){c.push(">"+(this.charAt(0)!=">"?" ":"")+this)});return c.join("\n")+"\n"}})})();
