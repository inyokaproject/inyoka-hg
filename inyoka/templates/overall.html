{#
    overall.html
    ~~~~~~~~~~~~

    This is the basic layout that is included by all templates.

    It contains the design elements that are displayed on all pages.

    :copyright: 2007 by Benjamin Wiegand.
    :license: GNU GPL.
#}
{%- include 'macros.html' -%}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>{{ (title_trace + ['ubuntuusers.de'])|join(' › ') }}</title>
    {%- block html_head %}
    {#- This way the local stylesheets can override styles without problems. #}
    {%- set styles = ['main.css'] + styles -%}
    {%- for style in styles %}
    <link rel="stylesheet" type="text/css" href="{{ href('static', 'style', style) }}" />
    {%- endfor %}
    <!--[if IE 6]><link rel="stylesheet" type="text/css" href="{{ href('static', 'style', 'ie.css') }}" /><![endif]-->
    {%- for title, url in feeds %}
    <link rel="alternate" href="{{ url|e }}" title="{{ title|e }}" type="application/atom+xml" />
    {%- endfor %}
    <link rel="shortcut icon" href="{{ href('static', 'img/favicon.ico') }}" />
    <script type="text/javascript">
    /*<![CDATA[*/
      var
        $STATIC_URL = {{ href('static')|jsonencode }},
        $MEDIA_URL = {{ href('media')|jsonencode }},
        $BASE_DOMAIN_NAME = {{ SETTINGS.BASE_DOMAIN_NAME|jsonencode }};
    /*]]>*/
    </script>
    {%- for script in ['jQuery.js', 'jQuery.Dimensions.js', 'overall.js'] + scripts %}
    <script type="text/javascript" src="{{ href('static', 'js/' + script) }}"></script>
    {%- endfor %}
    {%- endblock %}
  </head>
  <body>
    <div class="header">
      <h1><a href="/"><span>ubuntuusers.de</span></a></h1>

      <ul class="tabbar">
        {%- for app in ('portal', 'forum', 'wiki', 'ikhaya', 'planet') %}
        <li class="{{ app }}{% if app == active_app %} active{% endif %}">
          <a href="{{ href(app) }}">{{ app|capitalize }}</a>
        </li>
        {%- endfor %}
        <li class="community{% if active_app == 'community' %} active{% endif %}">
          <a href="{{ href('forum', 'community') }}">Talk</a>
        </li>
      </ul>{# .tabbar #}
    </div>{# .header #}

    <div class="appheader">
      {%- if not hide_quicklinks %}
      <ul class="mod_navi">
        {%- if report_count %}
        <li><strong><a href="{{ href('forum', 'reported_topics') }}">Gemeldete Themen ({{ report_count }})</a></strong></li>
        {%- else %}
        <li><a href="{{ href('forum', 'reported_topics') }}">Gemeldete Themen</a></li>
        {%- endif %}
        {%- if suggestion_count %}
        <li><strong><a href="{{ href('ikhaya', 'suggestions') }}">Artikelvorschläge ({{ suggestion_count }})</a></strong></li>
        {%- else %}
        <li><a href="{{ href('ikhaya', 'suggestions') }}">Artikelvorschläge</a></li>
        {%- endif %}
        <li><a href="{{ href('admin') }}">Adminbereich</a></li>
      </ul>
      <ul class="navi_global">
        {%- if USER.is_authenticated %}
        <li><a href="{{ href('portal', 'logout') }}">Logout [{{ USER.username|e }}]</a></li>
        <li><a href="{{ href('portal', 'usercp') }}">Kontrollzentrum</a></li>
        <li>
          {%- if pm_count %}
          <strong><a href="{{ href('portal', 'privmsg')}}">Private Nachrichten ({{ pm_count }})</a></strong>
          {%- else %}
          <a href="{{ href('portal', 'privmsg') }}">Private Nachrichten</a>
          {%- endif %}
        </li>
        {%- else %}
        <li><a href="{{ href('portal', 'login', next=CURRENT_URL) }}">Login</a></li>
        <li><a href="{{ href('portal', 'register') }}">Registrieren</a></li>
        {%- endif %}
      </ul>{# .navi_global #}
      {%- endif %}
      {% block appheader %}{% endblock %}
    </div>{# .appheader #}

    <div class="pathbar">
      <form action="{{ href('portal', 'search') }}" method="get" class="search">
        <p>
          <input type="text" name="q" class="search_query" />
          <select name="area" class="search_area">
            <option value="all" {% if active_app == 'portal' %} selected="selected" {% endif %}>Überall</option>
            <option value="forum" {% if active_app == 'forum' %} selected="selected" {% endif %}>Forum</option>
            <option value="wiki" {% if active_app == 'wiki' %} selected="selected" {% endif %}>Wiki</option>
            <option value="ikhaya" {% if active_app == 'ikhaya' %} selected="selected" {% endif %}>Ikhaya</option>
            <option value="planet" {% if active_app == 'planet' %} selected="selected" {% endif %}>Planet</option>
          </select>
          <input type="submit" value="Suchen" class="search_submit" />
        </p>
      </form>{# .search #}

      {%- for link, title in [(href('portal'), 'ubuntuusers.de')] +
        navigation_trace %}
        <a href="{{ link|e }}">{{ title|e }}</a>{% if not loop.last
          %} »{% endif %}
      {%- endfor %}
      <div style="clear:both;"></div>
    </div>{# .pathbar #}

    {%- if GLOBAL_MESSAGE %}
    <div class="message"><strong>Information:</strong> {{ GLOBAL_MESSAGE }}</div>
    {%- endif %}

    {%- for message in MESSAGES %}
    {%- if message.dialog %}
    <form class="message" action="{% if message.dialog_url != none %}{{ message.dialog_url }}{% else %}{{ CURRENT_URL }}{% endif %}" method="post">
      <p>{{ message.text }}</p>
      <p>
        <input type="submit" class="message-yes" name="message-yes" value="Ja" />
        <input type="submit" class="message-no" name="message-no" value="Nein" />
      </p>
    </form>
    {%- else %}
    <div class="message{% if message.success == true %} success{% elif message.success == false %} fail{% endif %}">
      {{ message.text }}
    </div>
    {%- endif %}
    {%- endfor %}

    <div class="page_content">
      {%- if navi_type -%}
      {%- if navi_type == 'tabbar' %}
      <div class="navi_tabbar navigation">
      {%- else %}
      <div class="navi_sidebar navigation">
      {%- endif %}
        {% block navigation %}{% endblock %}
      </div>{# .navi_tabbar .navi_sidebar .content #}
      
      {%- if navi_type == 'both' %}
      <div class="navi_tabbar navigation">
      {% block opt_tabbar_navigation %}{% endblock %}
      </div>
      {%- endif %}
      
      {%- if navi_type == 'tabbar' %}
      <div class="content_tabbar content">
      {%- else %}
      <div class="content_sidebar content">
      {%- endif %}
      {%- else %}
      <div class="content">
      {%- endif %}
        {%- block content %}{% endblock %}
      </div>{# .content_tabbar .content_sidebar .content #}
    </div>{# .page_content #}

    <div class="footer">
      <ul>
        <li class="poweredby">
          Powered by <a href="{{ href('portal', 'inyoka')|e }}">Inyoka</a><br />
          {%- if INYOKA_REVISION %}
          inyoka rev-{{ INYOKA_REVISION }}
          {%- else %}
          inyoka revision unavailable
          {%- endif %}
        </li>
        <li class="license">
          <img src="{{ href('static', 'img/copyleft.png') }}" alt="Copyleft" />
          2004 – 2007 ubuntuusers.de • Einige Rechte vorbehalten
          <br />
          <a href="{{ href('portal', 'lizenz') }}">Lizenz</a> •
          <a href="{{ href('portal', 'kontakt') }}">Kontakt</a> •
          <a href="{{ href('portal', 'datenschutz') }}">Datenschutz</a> •
          <a href="{{ href('portal', 'impressum') }}">Impressum</a>
        </li>
        <li class="housing">
          <span title="Unterbringung und Netzanbindung eines Servers">Serverhousing</span> gespendet von<br />
          <a href="http://www.noris.de/"><img src="{{ href('static', 'img/noris_logo.png') }}" alt="noris network" /></a>
        </li>
      </ul>
    </div>{# .footer #}
  </body>
</html>
