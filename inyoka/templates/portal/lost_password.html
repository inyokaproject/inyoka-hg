{#
    portal/lost_password
    ~~~~~~~~~~~~~~~~~~~~

    This page displays a formular where the user can create a new password
    if he lost the old one.

    :copyright: 2007 by Christopher Grebs, Benjamin Wiegand.
    :license: GNU GPL.
#}

{%- extends 'portal/overall.html' %}
{% from 'macros.html' import render_form %}
{% title_trace = ['Passwort vergessen'] %}
{% block appheader %}
  <h1>Portal</h1>
  <h2>Passwort vergessen</h2>
{% endblock %}
{% block portal_content %}
  <h3>Passwort vergessen</h3>
  <p>
    Du hast dein Passwort vergessen? Hier kannst du dir ein neues schicken lassen.
    Wenn du mehr als nur dein Passwort vergessen hast, kannst du auch nur die E-Mail-Adresse oder den Benutzernamen angeben.
  </p>
  {% if form.errors.__all__ %}{{ form.errors.__all__ }}{% endif %}
  <form action="" method="post">
    <p class="hide"><input type="submit" value="Registrieren" /></p>
    {# enter -> first submit field #}
    {{ render_form(form, ['username', 'email', 'captcha']) }}
    <p>
      <input type="submit" value="Neues Passwort beantragen" />
    </p>
    <script type="text/javascript">
      /*<![CDATA[*/
      (function() {
        var captcha_url = $('img.captcha').attr('src');
        $('input[@name="renew_captcha"]')
          .click(function() {
            var uid = Math.random().toString().substring(2, 10);
            $('img.captcha')
              .attr('src', captcha_url + '&rnd=' + uid);
            return false;
          });
        $('#id_username').focus();
      })();
      /*]]>*/
    </script>
  </form>
{% endblock %}
