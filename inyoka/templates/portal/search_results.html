{#
    portal/search_results.html
    ~~~~~~~~~~~~~~~~~~~~~~~~~~

    This page displays the search results.

    :copyright: 2007 by Christoph Hack.
    :license: GNU GPL.
#}


{% extends 'portal/overall.html' %}
{% set title = 'Suche' %}
{% block appheader %}
  <h1>Suche</h1>
  <h2>Ergebnisse für „{{ query|e }}“</h2>
{% endblock %}

{% block portal_content %}
  <h3>Suche</h3>
  <p>
    In der nachfolgenden Tabelle sind die Suchergbnisse für die Abfrage
    „{{ query|e }}“. Solltest du nicht fündig geworden sein kannst du eine
    <a href="/search/">neue Suche</a> mit veränderten Suchwörtern starten.
  </p>
  {%- if not show_all %}
  <div class="message">
    Aus Gründen der Übersichtlichkeit wurden manche Beiträge ausgeblendet:
    <a href="{{ href('portal', 'search', query=query, area=area, show_all="true")|e }}">
      Alles anzeigen
    </a>
  </div>
  {%- endif %}
  <table class="search_results">
    <thead>
      <tr>
        <th class="title">Titel</th>
        <th class="user">Autor</th>
        <th class="date">Datum</th>
        <th class="area">Bereich</th>
        <th class="score">Relevanz</th>
      </tr>
    </thead>
    <tbody>
      {%- for doc in results.results %}
      <tr>
        {#- XXX check urls here! #}
        <td class="title"><a href="{{ doc.url
          }}{% if doc.highlight %}?highlight={{ highlight|urlencode|e
          }}{% endif %}">{{ doc.title|e }}</a></td>
        <td class="user">{% if doc.user
          %}{% if doc.user and doc.user_url %}
          <a href="{{ doc.user_url }}">{{ doc.user|e }}</a>
          {% elif doc.user %}
          <a href="{{ doc.user|url }}">{{ doc.user|e }}</a>
          {% else %}{{ doc.user|e }}{% endif %}
          {% else %}Anonymous{% endif %}</td>
        <td class="date">{{ doc.date|datetimeformat|e }}</td>
        <td class="area">{{ doc.component|e }}</td>
        <td class="score">{{ doc.score|e }}</td>
      </tr>
      {%- endfor %}
    </tbody>
  </table>

  <p>Gehe zu:
  {% for page_nr in range(1, results.page_count+1) %}
    {% if page_nr == results.page %}
      <strong>{{ page_nr }}</strong>
    {% else %}
      <a href="{{ href('portal', 'search', page=page_nr, query=query,
        area=area, per_page=results.per_page) }}">{{ page_nr }}</a>
    {% endif %}
  {% endfor %}</p>
{% endblock %}
