{#
    forum/index.html
    ~~~~~~~~~~~~~~~~

    This is the forum's index page that shows all root-forums and their
    first-level subforums. It also displays some information about the
    forums like the last post and the overall topic / post count.

    :copyright: 2007 by Benjamin Wiegand.
    :license: GNU GPL.
#}
{%- extends 'forum/page.html' %}
{% set scripts = ['jQuery.Cookie.js'] + scripts|default([]) %}
{% from 'forum/_forum.html' import render_forum %}
{% if not is_index %}
  {% set title_trace = ['Kategorie „%s“'|format(categories[0].forum_name)] %}
  {% set navigation_trace = [
      (href('forum', 'category', categories[0].forum_slug), categories[0].forum_name|capitalize|e),
    ] + navigation_trace|default([]) %}
{% else %}
{% set title_trace = ['Index'] %}
  {% set feeds = [
    ('Forum - Nur Überschrift', href('forum', 'feeds/title/20')),
    ('Forum - Nur Einleitung', href('forum', 'feeds/short/20')),
    ('Forum - Ganzer Beitrag', href('forum', 'feeds/full/20'))
  ] %}
{% endif %}

{% block forum_content %}
  {%- if categories %}
  <table class="forum{% if is_index %} category_box{% endif %}">
  {%- for row in categories %}
  <tr class="head" id="category-{{ row.forum_id }}">
    <th colspan="5"><a href="{{ href('forum', 'category', row.forum_slug)
      }}">{{ row.forum_name|e }}</a></th></tr>
    {%- for forum in category.children -%}
      {{ render_forum(forum) }}
    {%- else %}
    <tr class="empty category-{{ category.id }}">
      <td colspan="5">Diese Kategorie enthält keine Foren.</td></tr>
    {%- endfor %}
  {%- endfor %}
  </table>
  {%- else %}
    <p>Keine Kategorien</p>
  {%- endif %}
  {% if hidden_categories %}
  <script type="text/javascript">
    $(function() {
      hideForumCategories({{ hidden_categories|jsonencode }});
    });
  </script>
  {% endif %}
{% endblock %}
