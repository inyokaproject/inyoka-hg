{#
    admin/monitoring.html
    ~~~~~~~~~~~~~~~~~~~~~

    :copyright: 2010 by Christopher Grebs.
    :license: GNU GPL.
#}
{%- extends 'admin/overall.html' %}
{% set navigation_trace = [
    (href('admin', 'monitoring'), 'Monitoring'),
  ] %}
{% set scripts = ['jQuery.visualize.js'] %}
{% set styles = ['visualize.css'] %}
{% block appheader %}
<h1><a href="{{ href('admin') }}">Administration</a></h1>
<h2><a href="{{ href('admin', 'monitoring') }}">Monitoring</a></h2>
{% endblock %}

{% block admin_content %}
<h3>Monitoring</h3>
<p class="linklist">
<a href="{{ href('admin', 'monitoring', 'errors') }}">Fehlermeldungen</a> |
<a href="{{ href('admin', 'monitoring', 'stats') }}">Detaillierte Statistiken</a>
</p>

<hr />
<h4>Fehlerstatistiken</h4>
<table class="errorstats">
  <tr>
    <th>Offen</th>
    <th>Geschlossen</th>
  </tr>
  <tr>
    <td>{{ stats['open'] }}</td>
    <td>{{ stats['closed'] }}</td>
  </tr>
</table>

<hr />
<h4>Aktuelle Fehlermeldungen</h4>
<table class="recent_errors">
  <thead>
  <tr>
    <th class="name"></th>
    <th class="date">{{ table.get_html('date', 'Zeitpunkt') }}</th>
    <th class="actions">Aktionen</th>
  </tr>
  </thead>
  <tbody>
  {%- for event in events %}
  <tr>
    <td class="name"><a href="{{ event|url }}">{{ event.name|e }}</a></td>
    <td class="date">{{ event.date|e }}</td>
    <td class="actions">
      <a href="{{ event|url('edit') }}" class="event_edit" title="Editieren" />
      <a href="{{ event|url('delete') }}" class="event_delete" title="LÃ¶schen" />
      <a href="{{ event|url('copy') }}" class="event_copy" title="Kopieren" />
    </td>
  </tr>
  {%- else %}
  <tr>
    <td colspan="3">Es wurden noch keine Veranstaltungen eingetragen, <a href="{{ href('admin', 'events', 'new') }}">erstelle</a> jetzt die erste!</td>
  </tr>
  {%- endfor %}
  </tbody>
</table>

<script type="text/javascript">
  /* <![CDATA[ */
  $(document).ready(function() {
    $('table.errorstats').visualize({
      type: 'pie',
      height: '200px',
      width: '420px',
      parseDirection: 'y',
      appendTitle: false
    });
    $('table.errorstats').hide();
  });
  /* ]]> */
</script>


{% endblock %}
